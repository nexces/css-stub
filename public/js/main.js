document.addEventListener('DOMContentLoaded', function () {
    var $container = document.querySelector('.siteHeader');
    var $menuSwitch = document.querySelector('#nav-toggle');
    console.log('menu-collapse :: init');
    $menuSwitch.addEventListener('click', function (e) {
        console.log('menu-collapse :: handling event on #nav-toggle');
        e.preventDefault();
        e.stopPropagation();
        e.stopImmediatePropagation();
        $container.classList.toggle('nav-active');
    }, false);
    document.body.addEventListener('click', function () {
        console.log('menu-collapse :: handling event on body');
        $container.classList.remove('nav-active');
    }, false);
}, false);
var Slider = (function () {
    function Slider(sliderSelector) {
        var _this = this;
        this.nextSlideDelay = 5000;
        this.transition = 'fading';
        this.autoProgress = true;
        this.allReady = false;
        this.heightGuard = function () {
            _this.$slidesContainer.style.height = null;
            _this.$slidesContainer.style.height = _this.$slidesContainer.clientHeight + 'px';
        };
        this.handleHover = function (e) {
            console.debug('Slider::handleHover()');
            if (e.type === 'mouseover') {
                _this.autoProgress = false;
                _this.blockAutoProgress();
            }
            if (e.type === 'mouseout') {
                _this.autoProgress = true;
                _this.resumeAutoProgress();
            }
        };
        this.blockAutoProgress = function () {
            console.debug('Slider::blockAutoProgress()');
            clearTimeout(_this.nextSlideTimeout);
            _this.nextSlideTimeout = 0;
        };
        this.resumeAutoProgress = function () {
            console.debug('Slider::resumeAutoProgress()');
            if (_this.allReady && _this.autoProgress && _this.nextSlideDelay > 0) {
                _this.nextSlideTimeout = setTimeout(_this.loadSlide, _this.nextSlideDelay);
            }
        };
        this.loadSlide = function (num) {
            _this.blockAutoProgress();
            if (!_this.allReady) {
                return false;
            }
            var $current, currentData, $next, nextData, currentNum, nextNum, $currentDot, $nextDot;
            $current = _this.$slider.querySelector('.slide.active');
            if (!num) {
                if (!$current) {
                    $next = _this.$slider.querySelector('.slide.initial');
                }
                else {
                    $next = _this.$slider.querySelector('.slide.active + .slide');
                }
                if (!$next) {
                    $next = _this.$slider.querySelector('.slide:nth-child(1)');
                }
            }
            else {
                $next = _this.$slider.querySelector('.slide:nth-child(' + num + ')');
            }
            nextData = $next.dataset;
            if ($current) {
                $current.classList.remove('active');
                currentData = $current.dataset;
                currentNum = currentData.num || $current.className.match(/slide-(\d+)/)[1];
                if (_this.$dotsContainer) {
                    $currentDot = _this.$dotsContainer.querySelector('.dot:nth-child(' + currentNum + ')');
                    $currentDot.classList.remove('active');
                }
            }
            $next.classList.remove('initial');
            $next.classList.add('active');
            nextNum = nextData.num || $next.className.match(/slide-(\d+)/)[1];
            _this.$slider.className = _this.$slider.className.replace(/slide-(\d+)-active/, '');
            _this.$slider.classList.add('slide-' + nextNum + '-active');
            if (_this.$dotsContainer) {
                $nextDot = _this.$dotsContainer.querySelector('.dot:nth-child(' + nextNum + ')');
                $nextDot.classList.add('active');
            }
            _this.resumeAutoProgress();
        };
        this.arrowClick = function (e) {
            var $next, nextData, num, $arrow = e.target;
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            if ($arrow.classList.contains('prev')) {
                $next = _this.$slider.querySelector('.slide + .slide.active');
                if ($next) {
                    $next = $next.previousElementSibling;
                }
                else {
                    $next = _this.$slider.querySelector('.slide:last-of-type');
                }
            }
            if ($arrow.classList.contains('next')) {
                $next = (_this.$slider.querySelector('.slide.active + .slide') || _this.$slider.querySelector('.slide:nth-child(1)'));
            }
            nextData = $next.dataset;
            num = nextData.num || $next.className.match(/slide-(\d+)/)[1];
            _this.loadSlide(num);
        };
        this.dotClick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            var $dot = e.target;
            var dotData = $dot.dataset;
            var num = parseInt(dotData.num || e.target.className.match(/slide-(\d+)/)[1]);
            _this.loadSlide(num);
        };
        this.imgReadyNotification = function (e) {
            var $img = e.target;
            var imgData = $img.dataset;
            imgData.ready = 'true';
            _this.heightGuard();
        };
        this.imgReadyWait = function () {
            var $$img = _this.$slider.querySelectorAll('.slide img[data-ready="false"]');
            if ($$img.length > 0) {
                setTimeout(_this.imgReadyWait, 100);
                _this.$slider.classList.add('waiting');
                return false;
            }
            _this.allReady = true;
            _this.$slider.classList.remove('waiting');
            _this.$slider.classList.add('ready');
            _this.loadSlide();
        };
        console.log('Slider::constructor()');
        this.$slider = document.querySelector(sliderSelector);
        if (!this.$slider) {
            console.warn('Slider::constructor() => no slider found via "%s"', sliderSelector);
            return;
        }
        if (this.$slider.classList.contains('sliding')) {
            this.transition = 'sliding';
        }
        var sliderData = this.$slider.dataset;
        if (sliderData.delay) {
            this.nextSlideDelay = parseInt(sliderData.delay);
        }
        this.$slidesContainer = this.$slider.querySelector('.slides');
        if (!this.$slidesContainer) {
            console.error('Slider::constructor() => Slides should be placed in ".slides" container');
            return;
        }
        this.$$slides = this.$slidesContainer.querySelectorAll('.slide');
        if (this.$$slides.length == 0) {
            console.log('Slider::constructor() => nothing to rotate');
            return;
        }
        this.$dotsContainer = this.$slider.querySelector('.dots');
        if (this.$$slides.length > 1) {
            this.$slider.classList.add('controllable');
        }
        this.$slider.addEventListener('mouseover', this.handleHover, false);
        this.$slider.addEventListener('mouseout', this.handleHover, false);
        if (this.$slider.querySelector('.prev')) {
            this.$slider.querySelector('.prev').addEventListener('click', this.arrowClick, false);
        }
        if (this.$slider.querySelector('.next')) {
            this.$slider.querySelector('.next').addEventListener('click', this.arrowClick, false);
        }
        if (this.transition == 'sliding') {
            this.$slidesContainer.style.width = (this.$$slides.length * 100) + '%';
        }
        for (var i = 0; i < this.$$slides.length; i++) {
            var $slide = this.$$slides[i];
            var slideData = $slide.dataset;
            slideData.num = (i + 1).toString();
            $slide.classList.add('slide-' + slideData.num);
            if (this.$dotsContainer) {
                var $currentDot = document.createElement('span');
                var currentDotData = $currentDot.dataset;
                $currentDot.className = 'dot';
                currentDotData.num = (i + 1).toString();
                $currentDot.classList.add('slide-' + currentDotData.num);
                $currentDot.addEventListener('click', this.dotClick, false);
                this.$dotsContainer.appendChild($currentDot);
            }
            var $$imgs = $slide.querySelectorAll('img');
            for (var i2 = 0; i2 < $$imgs.length; i2++) {
                var $img = $$imgs[i2];
                var imgData = $img.dataset;
                imgData.ready = $img.complete ? 'true' : 'false';
                $img.addEventListener('load', this.imgReadyNotification);
            }
            var $imgSrc = $slide.querySelector('.src');
            if ($imgSrc) {
                $slide.style.backgroundImage = 'url(' + $imgSrc.src + ')';
            }
        }
        this.heightGuard();
        window.addEventListener('resize', this.heightGuard, false);
        this.imgReadyWait();
    }
    return Slider;
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NvdXJjZXMvdHMvbWVudS1jb2xsYXBzZS50cyIsIi4uLy4uL3NvdXJjZXMvdHMvc2xpZGVyLnRzIl0sIm5hbWVzIjpbIlNsaWRlciIsIlNsaWRlci5jb25zdHJ1Y3RvciJdLCJtYXBwaW5ncyI6IkFBR0EsUUFBUSxDQUFDLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFO0lBQzFDLElBQUksVUFBVSxHQUFpQixRQUFRLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3JFLElBQUksV0FBVyxHQUFpQixRQUFRLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3RFLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQztJQUNyQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQztRQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLGdEQUFnRCxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ25CLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUNwQixDQUFDLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztRQUM3QixVQUFVLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUM5QyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDVixRQUFRLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRTtRQUNwQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7UUFDdkQsVUFBVSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDOUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQ2QsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FDSFY7SUFjSUEsZ0JBQVlBLGNBQXNCQTtRQWR0Q0MsaUJBOE5DQTtRQTdOV0EsbUJBQWNBLEdBQUdB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QSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUMzQkEsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsU0FBU0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsY0FBY0EsQ0FBQ0EsQ0FBQ0E7UUFDL0NBLENBQUNBO1FBRURBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLGdCQUFnQkEsQ0FBQ0EsV0FBV0EsRUFBRUEsSUFBSUEsQ0FBQ0EsV0FBV0EsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFDcEVBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLGdCQUFnQkEsQ0FBQ0EsVUFBVUEsRUFBRUEsSUFBSUEsQ0FBQ0EsV0FBV0EsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFFbkVBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ3RDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxnQkFBZ0JBLENBQUNBLE9BQU9BLEVBQUVBLElBQUlBLENBQUNBLFVBQVVBLEVBQUVBLEtBQUtBLENBQUNBLENBQUNBO1FBQzFGQSxDQUFDQTtRQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN0Q0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxPQUFPQSxFQUFFQSxJQUFJQSxDQUFDQSxVQUFVQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUMxRkEsQ0FBQ0E7UUFFREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsSUFBSUEsU0FBU0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDL0JBLElBQUlB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LENBQUNBO1FBRURBLElBQUlBLENBQUNBLFdBQVdBLEVBQUVBLENBQUNBO1FBQ25CQSxNQUFNQSxDQUFDQSxnQkFBZ0JBLENBQUNBLFFBQVFBLEVBQUVBLElBQUlBLENBQUNBLFdBQVdBLEVBQUVBLEtBQUtBLENBQUNBLENBQUNBO1FBRTNEQSxJQUFJQSxDQUFDQSxZQUFZQSxFQUFFQSxDQUFDQTtJQUN4QkEsQ0FBQ0E7SUE0SExELGFBQUNBO0FBQURBLENBQUNBLEFBOU5ELElBOE5DIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IGFkcmlhbnAgb24gMzAuMDYuMTUuXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyICRjb250YWluZXIgPSA8SFRNTEVsZW1lbnQ+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaXRlSGVhZGVyJyk7XG4gICAgdmFyICRtZW51U3dpdGNoID0gPEhUTUxFbGVtZW50PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmF2LXRvZ2dsZScpO1xuICAgIGNvbnNvbGUubG9nKCdtZW51LWNvbGxhcHNlIDo6IGluaXQnKTtcbiAgICAkbWVudVN3aXRjaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdtZW51LWNvbGxhcHNlIDo6IGhhbmRsaW5nIGV2ZW50IG9uICNuYXYtdG9nZ2xlJyk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgJGNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCduYXYtYWN0aXZlJyk7XG4gICAgfSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdtZW51LWNvbGxhcHNlIDo6IGhhbmRsaW5nIGV2ZW50IG9uIGJvZHknKTtcbiAgICAgICAgJGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCduYXYtYWN0aXZlJyk7XG4gICAgfSwgZmFsc2UpO1xufSwgZmFsc2UpO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGFkcmlhbnAgb24gMDIuMDcuMTUuXG4gKi9cbmludGVyZmFjZSBTbGlkZXJEYXRhIGV4dGVuZHMgRE9NU3RyaW5nTWFwIHtcbiAgICBkZWxheTogc3RyaW5nO1xufVxuaW50ZXJmYWNlIFNsaWRlRGF0YSBleHRlbmRzIERPTVN0cmluZ01hcCB7XG4gICAgbnVtOiBzdHJpbmc7XG59XG5pbnRlcmZhY2UgRG90RGF0YSBleHRlbmRzIERPTVN0cmluZ01hcCB7XG4gICAgbnVtOiBzdHJpbmc7XG59XG5pbnRlcmZhY2UgSW1nRGF0YSBleHRlbmRzIERPTVN0cmluZ01hcCB7XG4gICAgcmVhZHk6IHN0cmluZztcbn1cbmNsYXNzIFNsaWRlciB7XG4gICAgcHJpdmF0ZSBuZXh0U2xpZGVEZWxheSA9IDUwMDA7XG4gICAgcHJpdmF0ZSBuZXh0U2xpZGVUaW1lb3V0O1xuXG4gICAgcHJpdmF0ZSB0cmFuc2l0aW9uID0gJ2ZhZGluZyc7XG5cbiAgICBwcml2YXRlICRzbGlkZXI6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgJHNsaWRlc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSAkJHNsaWRlczogTm9kZUxpc3Q7XG4gICAgcHJpdmF0ZSAkZG90c0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cbiAgICBwcml2YXRlIGF1dG9Qcm9ncmVzcyA9IHRydWU7XG4gICAgcHJpdmF0ZSBhbGxSZWFkeSA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3Ioc2xpZGVyU2VsZWN0b3I6IHN0cmluZylcbiAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTbGlkZXI6OmNvbnN0cnVjdG9yKCknKTtcbiAgICAgICAgdGhpcy4kc2xpZGVyID0gPEhUTUxFbGVtZW50PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNsaWRlclNlbGVjdG9yKTtcbiAgICAgICAgaWYgKCF0aGlzLiRzbGlkZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignU2xpZGVyOjpjb25zdHJ1Y3RvcigpID0+IG5vIHNsaWRlciBmb3VuZCB2aWEgXCIlc1wiJywgc2xpZGVyU2VsZWN0b3IpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuJHNsaWRlci5jbGFzc0xpc3QuY29udGFpbnMoJ3NsaWRpbmcnKSkge1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uID0gJ3NsaWRpbmcnO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNsaWRlckRhdGEgPSA8U2xpZGVyRGF0YT4gdGhpcy4kc2xpZGVyLmRhdGFzZXQ7XG4gICAgICAgIGlmIChzbGlkZXJEYXRhLmRlbGF5KSB7XG4gICAgICAgICAgICB0aGlzLm5leHRTbGlkZURlbGF5ID0gcGFyc2VJbnQoc2xpZGVyRGF0YS5kZWxheSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLiRzbGlkZXNDb250YWluZXIgPSA8SFRNTEVsZW1lbnQ+IHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGVzJyk7XG4gICAgICAgIGlmICghdGhpcy4kc2xpZGVzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTbGlkZXI6OmNvbnN0cnVjdG9yKCkgPT4gU2xpZGVzIHNob3VsZCBiZSBwbGFjZWQgaW4gXCIuc2xpZGVzXCIgY29udGFpbmVyJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kJHNsaWRlcyA9IHRoaXMuJHNsaWRlc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGUnKTtcblxuICAgICAgICBpZiAodGhpcy4kJHNsaWRlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NsaWRlcjo6Y29uc3RydWN0b3IoKSA9PiBub3RoaW5nIHRvIHJvdGF0ZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kZG90c0NvbnRhaW5lciA9IDxIVE1MRWxlbWVudD4gdGhpcy4kc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kb3RzJyk7XG5cbiAgICAgICAgaWYgKHRoaXMuJCRzbGlkZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhpcy4kc2xpZGVyLmNsYXNzTGlzdC5hZGQoJ2NvbnRyb2xsYWJsZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHRoaXMuaGFuZGxlSG92ZXIsIGZhbHNlKTtcbiAgICAgICAgdGhpcy4kc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5oYW5kbGVIb3ZlciwgZmFsc2UpO1xuXG4gICAgICAgIGlmICh0aGlzLiRzbGlkZXIucXVlcnlTZWxlY3RvcignLnByZXYnKSkge1xuICAgICAgICAgICAgdGhpcy4kc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5wcmV2JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFycm93Q2xpY2ssIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy4kc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5uZXh0JykpIHtcbiAgICAgICAgICAgIHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yKCcubmV4dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5hcnJvd0NsaWNrLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9uID09ICdzbGlkaW5nJykge1xuICAgICAgICAgICAgdGhpcy4kc2xpZGVzQ29udGFpbmVyLnN0eWxlLndpZHRoID0gKHRoaXMuJCRzbGlkZXMubGVuZ3RoICogMTAwKSArICclJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpPCB0aGlzLiQkc2xpZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgJHNsaWRlID0gPEhUTUxFbGVtZW50PiB0aGlzLiQkc2xpZGVzW2ldO1xuICAgICAgICAgICAgdmFyIHNsaWRlRGF0YSA9IDxTbGlkZURhdGE+ICRzbGlkZS5kYXRhc2V0O1xuICAgICAgICAgICAgc2xpZGVEYXRhLm51bSA9IChpKzEpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAkc2xpZGUuY2xhc3NMaXN0LmFkZCgnc2xpZGUtJyArIHNsaWRlRGF0YS5udW0pO1xuXG4gICAgICAgICAgICBpZiAodGhpcy4kZG90c0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIHZhciAkY3VycmVudERvdCA9IDxIVE1MU3BhbkVsZW1lbnQ+IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudERvdERhdGEgPSA8RG90RGF0YT4gJGN1cnJlbnREb3QuZGF0YXNldDtcbiAgICAgICAgICAgICAgICAkY3VycmVudERvdC5jbGFzc05hbWUgPSAnZG90JztcbiAgICAgICAgICAgICAgICBjdXJyZW50RG90RGF0YS5udW0gPSAoaSsxKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICRjdXJyZW50RG90LmNsYXNzTGlzdC5hZGQoJ3NsaWRlLScgKyBjdXJyZW50RG90RGF0YS5udW0pO1xuXG4gICAgICAgICAgICAgICAgJGN1cnJlbnREb3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRvdENsaWNrLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy4kZG90c0NvbnRhaW5lci5hcHBlbmRDaGlsZCgkY3VycmVudERvdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciAkJGltZ3MgPSAkc2xpZGUucXVlcnlTZWxlY3RvckFsbCgnaW1nJyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpMiA9IDA7IGkyIDwgJCRpbWdzLmxlbmd0aDsgaTIrKykge1xuICAgICAgICAgICAgICAgIHZhciAkaW1nID0gPEhUTUxJbWFnZUVsZW1lbnQ+ICQkaW1nc1tpMl07XG4gICAgICAgICAgICAgICAgdmFyIGltZ0RhdGEgPSA8SW1nRGF0YT4gJGltZy5kYXRhc2V0O1xuICAgICAgICAgICAgICAgIGltZ0RhdGEucmVhZHkgPSAkaW1nLmNvbXBsZXRlID8gJ3RydWUnIDogJ2ZhbHNlJztcbiAgICAgICAgICAgICAgICAkaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCB0aGlzLmltZ1JlYWR5Tm90aWZpY2F0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciAkaW1nU3JjID0gPEhUTUxJbWFnZUVsZW1lbnQ+ICRzbGlkZS5xdWVyeVNlbGVjdG9yKCcuc3JjJyk7XG4gICAgICAgICAgICBpZiAoJGltZ1NyYykge1xuICAgICAgICAgICAgICAgICRzbGlkZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKCcgKyAkaW1nU3JjLnNyYyArICcpJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaGVpZ2h0R3VhcmQoKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGVpZ2h0R3VhcmQsIGZhbHNlKTtcblxuICAgICAgICB0aGlzLmltZ1JlYWR5V2FpdCgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGVpZ2h0R3VhcmQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuJHNsaWRlc0NvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBudWxsO1xuICAgICAgICB0aGlzLiRzbGlkZXNDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gdGhpcy4kc2xpZGVzQ29udGFpbmVyLmNsaWVudEhlaWdodCArICdweCc7XG4gICAgfTtcblxuICAgIHB1YmxpYyBoYW5kbGVIb3ZlciA9IChlOiBFdmVudCkgPT4ge1xuICAgICAgICBjb25zb2xlLmRlYnVnKCdTbGlkZXI6OmhhbmRsZUhvdmVyKCknKTtcbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ21vdXNlb3ZlcicpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0b1Byb2dyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmJsb2NrQXV0b1Byb2dyZXNzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ21vdXNlb3V0Jykge1xuICAgICAgICAgICAgdGhpcy5hdXRvUHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZXN1bWVBdXRvUHJvZ3Jlc3MoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwdWJsaWMgYmxvY2tBdXRvUHJvZ3Jlc3MgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ1NsaWRlcjo6YmxvY2tBdXRvUHJvZ3Jlc3MoKScpO1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5uZXh0U2xpZGVUaW1lb3V0KTtcbiAgICAgICAgdGhpcy5uZXh0U2xpZGVUaW1lb3V0ID0gMDtcbiAgICB9O1xuXG4gICAgcHVibGljIHJlc3VtZUF1dG9Qcm9ncmVzcyA9ICgpID0+IHtcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnU2xpZGVyOjpyZXN1bWVBdXRvUHJvZ3Jlc3MoKScpO1xuICAgICAgICBpZiAodGhpcy5hbGxSZWFkeSAmJiB0aGlzLmF1dG9Qcm9ncmVzcyAmJiB0aGlzLm5leHRTbGlkZURlbGF5ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5uZXh0U2xpZGVUaW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLmxvYWRTbGlkZSwgdGhpcy5uZXh0U2xpZGVEZWxheSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHVibGljIGxvYWRTbGlkZSA9IChudW0/OiBudW1iZXIpID0+IHtcbiAgICAgICAgdGhpcy5ibG9ja0F1dG9Qcm9ncmVzcygpO1xuICAgICAgICBpZiAoIXRoaXMuYWxsUmVhZHkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgJGN1cnJlbnQsIGN1cnJlbnREYXRhLCAkbmV4dCwgbmV4dERhdGEsIGN1cnJlbnROdW0sIG5leHROdW0sICRjdXJyZW50RG90LCAkbmV4dERvdDtcbiAgICAgICAgJGN1cnJlbnQgPSA8SFRNTEVsZW1lbnQ+IHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGUuYWN0aXZlJyk7XG5cbiAgICAgICAgaWYgKCFudW0pIHtcbiAgICAgICAgICAgIGlmICghJGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICAkbmV4dCA9IDxIVE1MRWxlbWVudD4gdGhpcy4kc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZS5pbml0aWFsJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRuZXh0ID0gPEhUTUxFbGVtZW50PiB0aGlzLiRzbGlkZXIucXVlcnlTZWxlY3RvcignLnNsaWRlLmFjdGl2ZSArIC5zbGlkZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEkbmV4dCkge1xuICAgICAgICAgICAgICAgICRuZXh0ID0gPEhUTUxFbGVtZW50PiB0aGlzLiRzbGlkZXIucXVlcnlTZWxlY3RvcignLnNsaWRlOm50aC1jaGlsZCgxKScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJG5leHQgPSA8SFRNTEVsZW1lbnQ+IHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGU6bnRoLWNoaWxkKCcgKyBudW0gKyAnKScpO1xuICAgICAgICB9XG4gICAgICAgIG5leHREYXRhID0gPFNsaWRlRGF0YT4gJG5leHQuZGF0YXNldDtcbiAgICAgICAgaWYgKCRjdXJyZW50KSB7XG4gICAgICAgICAgICAkY3VycmVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIGN1cnJlbnREYXRhID0gPFNsaWRlRGF0YT4gJGN1cnJlbnQuZGF0YXNldDtcbiAgICAgICAgICAgIGN1cnJlbnROdW0gPSBjdXJyZW50RGF0YS5udW0gfHwgJGN1cnJlbnQuY2xhc3NOYW1lLm1hdGNoKC9zbGlkZS0oXFxkKykvKVsxXTtcbiAgICAgICAgICAgIGlmICh0aGlzLiRkb3RzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgJGN1cnJlbnREb3QgPSA8SFRNTEVsZW1lbnQ+IHRoaXMuJGRvdHNDb250YWluZXIucXVlcnlTZWxlY3RvcignLmRvdDpudGgtY2hpbGQoJyArIGN1cnJlbnROdW0gKyAnKScpO1xuICAgICAgICAgICAgICAgICRjdXJyZW50RG90LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICRuZXh0LmNsYXNzTGlzdC5yZW1vdmUoJ2luaXRpYWwnKTtcbiAgICAgICAgJG5leHQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgIG5leHROdW0gPSBuZXh0RGF0YS5udW0gfHwgJG5leHQuY2xhc3NOYW1lLm1hdGNoKC9zbGlkZS0oXFxkKykvKVsxXTtcbiAgICAgICAgdGhpcy4kc2xpZGVyLmNsYXNzTmFtZSA9IHRoaXMuJHNsaWRlci5jbGFzc05hbWUucmVwbGFjZSgvc2xpZGUtKFxcZCspLWFjdGl2ZS8sICcnKTtcbiAgICAgICAgdGhpcy4kc2xpZGVyLmNsYXNzTGlzdC5hZGQoJ3NsaWRlLScgKyBuZXh0TnVtICsgJy1hY3RpdmUnKTtcbiAgICAgICAgaWYgKHRoaXMuJGRvdHNDb250YWluZXIpIHtcbiAgICAgICAgICAgICRuZXh0RG90ID0gPEhUTUxFbGVtZW50PiB0aGlzLiRkb3RzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5kb3Q6bnRoLWNoaWxkKCcgKyBuZXh0TnVtICsgJyknKTtcbiAgICAgICAgICAgICRuZXh0RG90LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzdW1lQXV0b1Byb2dyZXNzKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhcnJvd0NsaWNrID0gKGUpID0+IHtcbiAgICAgICAgdmFyICRuZXh0LCBuZXh0RGF0YSwgbnVtLCAkYXJyb3cgPSA8SFRNTEVsZW1lbnQ+IGUudGFyZ2V0O1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGlmICgkYXJyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdwcmV2JykpIHtcbiAgICAgICAgICAgICRuZXh0ID0gPEhUTUxFbGVtZW50PiB0aGlzLiRzbGlkZXIucXVlcnlTZWxlY3RvcignLnNsaWRlICsgLnNsaWRlLmFjdGl2ZScpO1xuICAgICAgICAgICAgaWYgKCRuZXh0KSB7XG4gICAgICAgICAgICAgICAgJG5leHQgPSAkbmV4dC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkbmV4dCA9IDxIVE1MRWxlbWVudD4gdGhpcy4kc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZTpsYXN0LW9mLXR5cGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoJGFycm93LmNsYXNzTGlzdC5jb250YWlucygnbmV4dCcpKSB7XG4gICAgICAgICAgICAkbmV4dCA9IDxIVE1MRWxlbWVudD4gKHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGUuYWN0aXZlICsgLnNsaWRlJykgfHwgdGhpcy4kc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZTpudGgtY2hpbGQoMSknKSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dERhdGEgPSA8U2xpZGVEYXRhPiAkbmV4dC5kYXRhc2V0O1xuICAgICAgICBudW0gPSBuZXh0RGF0YS5udW0gfHwgJG5leHQuY2xhc3NOYW1lLm1hdGNoKC9zbGlkZS0oXFxkKykvKVsxXTtcbiAgICAgICAgdGhpcy5sb2FkU2xpZGUobnVtKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGRvdENsaWNrID0gKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICB2YXIgJGRvdCA9IDxIVE1MRWxlbWVudD4gZS50YXJnZXQ7XG4gICAgICAgIHZhciBkb3REYXRhID0gPERvdERhdGE+ICRkb3QuZGF0YXNldDtcbiAgICAgICAgdmFyIG51bSA9IHBhcnNlSW50KGRvdERhdGEubnVtIHx8IGUudGFyZ2V0LmNsYXNzTmFtZS5tYXRjaCgvc2xpZGUtKFxcZCspLylbMV0pO1xuICAgICAgICB0aGlzLmxvYWRTbGlkZShudW0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgaW1nUmVhZHlOb3RpZmljYXRpb24gPSAoZSkgPT4ge1xuICAgICAgICB2YXIgJGltZyA9IDxIVE1MSW1hZ2VFbGVtZW50PiBlLnRhcmdldDtcbiAgICAgICAgdmFyIGltZ0RhdGEgPSA8SW1nRGF0YT4gJGltZy5kYXRhc2V0O1xuICAgICAgICBpbWdEYXRhLnJlYWR5ID0gJ3RydWUnO1xuICAgICAgICB0aGlzLmhlaWdodEd1YXJkKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBpbWdSZWFkeVdhaXQgPSAoKSA9PiB7XG4gICAgICAgIHZhciAkJGltZyA9IHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGUgaW1nW2RhdGEtcmVhZHk9XCJmYWxzZVwiXScpO1xuICAgICAgICBpZiAoJCRpbWcubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc2V0VGltZW91dCh0aGlzLmltZ1JlYWR5V2FpdCwgMTAwKTtcbiAgICAgICAgICAgIHRoaXMuJHNsaWRlci5jbGFzc0xpc3QuYWRkKCd3YWl0aW5nJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbGxSZWFkeSA9IHRydWU7XG4gICAgICAgIHRoaXMuJHNsaWRlci5jbGFzc0xpc3QucmVtb3ZlKCd3YWl0aW5nJyk7XG4gICAgICAgIHRoaXMuJHNsaWRlci5jbGFzc0xpc3QuYWRkKCdyZWFkeScpO1xuICAgICAgICB0aGlzLmxvYWRTbGlkZSgpO1xuICAgIH07XG59XG5cbiJdfQ==